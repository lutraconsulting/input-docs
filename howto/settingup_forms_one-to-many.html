<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>1-N (one-to-many) relation | Input Help</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="1-N (one-to-many) relation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Survey made easy" />
<meta property="og:description" content="Survey made easy" />
<link rel="canonical" href="/howto/settingup_forms_one-to-many" />
<meta property="og:url" content="/howto/settingup_forms_one-to-many" />
<meta property="og:site_name" content="Input Help" />
<script type="application/ld+json">
{"description":"Survey made easy","url":"/howto/settingup_forms_one-to-many","@type":"WebPage","headline":"1-N (one-to-many) relation","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Input Help" /><!-- based on default minima template https://github.com/jekyll/minima/blob/master/_includes/google-analytics.html -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-144776738-1"></script>
<script>
  window['ga-disable-UA-144776738-1'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  // we need more settings than in default template
  gtag('config', 'UA-144776738-1', {
    'linker': {
      'domains': ['inputapp.io', 'cloudmergin.com'],
      'accept_incoming': true
    },
    'anonymize_ip': true
  });
</script>
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">
    <img src="https://inputapp.io/img/logo.svg" style="margin-top: -10px" width="90">
    <!--Input Help-->
    </a> <span class="site-title"> &nbsp; Help Center</span><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/quick-start.html">Quick Start Guide</a><a class="page-link" href="/faq">FAQ</a><a class="page-link" href="/developers.html">Developers</a><a class="page-link" href="/support">Support</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">1-N (one-to-many) relation</h1>
  </header>

  <div class="post-content">
    <h2 id="1-n-relations">1-N relations</h2>

<p>It is often the case that you have a set of spatial features and you want to record some parameters every now and then. For example, there is a GIS layer representing the manholes and the surveyors carry out regular inspections of the manholes. Instead of duplicating the manhole layer and recording each inspection, you can create a non-spatial table and store each inspection as a new line.</p>

<p>The image below shows the manholes locations:</p>

<p><img src="../images/input_forms_many-relations_concept1.png" alt="Manhole locations" /></p>

<p>The manhole point layer has the following attribute table:</p>

<p><img src="../images/input_forms_many-relations_concept2.png" alt="Manhole locations" /></p>

<p>In a separate table (which is non-spatial), we can record the inspections:</p>

<p><img src="../images/input_forms_many-relations_concept3.png" alt="Manhole locations" /></p>

<p>In QGIS, we are using the <strong>Manhole ID</strong> from the point layer and the inspection table, to create a 1-N relationship between the two tables.</p>

<p>Another example is when you try to capture multiple photos for a single feature.</p>

<p>In the sections below, you can see how this type of relations can be set up in QGIS and utilised in the Input app.</p>

<h3 id="project-preparation-in-qgis">Project preparation in QGIS</h3>

<p>See the example projects:</p>
<ul>
  <li>Assigning multiple inspections to a single feature: <a href="https://public.cloudmergin.com/projects/documentation/forms_one-to-many-relations">example project</a></li>
  <li>Adding multiple photos to a single feature: <a href="https://public.cloudmergin.com/projects/documentation/forms_multiple_photos">example project</a></li>
</ul>

<p>To configure 1-N relations in QGIS:</p>
<ul>
  <li>From the main menu, select <strong>Projects</strong> &gt; <strong>Properties …</strong></li>
  <li>In the new window, select the <strong>Relations</strong> tab</li>
  <li>Select <strong>Add Relation</strong> to create a new one</li>
  <li>A new window will appear, where we can define the parent and child layers and the fields to link the two layers:
    <ul>
      <li>For <strong>Name</strong> type <strong>Inspection</strong></li>
      <li>For the <strong>Referenced(parent)</strong> layer, select <strong>manhole_locations</strong></li>
      <li>For <strong>Field 1</strong> of the <strong>Referenced(parent)</strong> layer, select <strong>Manhole</strong></li>
      <li>For the <strong>Referencing(child)</strong> layer, select <strong>inspections</strong></li>
      <li>For <strong>Field 1</strong> of the <strong>Referencing(child)</strong> layer, select <strong>Manhole ID</strong></li>
    </ul>
  </li>
</ul>

<p><img src="../images/input_forms_many-relations1.png" alt="1-N relations in QGIS" /></p>

<p>This should now allow you to add multiple inspections for each manhole location (<strong>manhole_locations</strong> point layer). The inspections records will be stored in the <strong>inspections</strong> table.</p>

<p>When you open the form for an existing record in the  <strong>manhole_locations</strong> point layer, you should be able to see the existing inspection records and optionally add, delete or edit the records:</p>

<p><img src="../images/input_forms_many-relations2.png" alt="1-N relations in QGIS - form view" /></p>

<p>The same project when you open add inspection to a manhole in Input will look like the image below:</p>

<p><img src="../images/input_forms_one-to-many.png" alt="Many photos to a single feature" /></p>

<h3 id="link-multiple-photos-to-a-single-feature">Link multiple photos to a single feature</h3>

<p>Another use-case for having multiple photos linked to a single feature is using 1-N relation.</p>

<p>To set up a project in QGIS, similar to the previous example, we need a unique field to link the following two tables:</p>
<ul>
  <li>Survey layer (containing spatial information)</li>
  <li>A non-spatial table containing path to the photos</li>
</ul>

<p>The key part when linking the above to table is to avoid using <strong>FID</strong> field in the GeoPackage. Mergin uses the FID to consolidate changes and therefore can change the FIDs. This will result in having photos linked to the incorrect feature on the map.</p>

<p>For that, we can create a new field and use the <strong>uuid()</strong> as the default value. To learn more about how this can be configured, you can see the <a href="https://public.cloudmergin.com/projects/documentation/forms_multiple_photos">example project</a>.</p>

<p>Input detects the type of 1-N relation is for “Attachment” widget and displays the image viewer for the relations.</p>

<p><img src="../images/input_forms_many-photos.png" alt="Many photos to a single feature" /></p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Input Help</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Input Help</li><li><a class="u-email" href="mailto:info@lutraconsulting.co.uk">info@lutraconsulting.co.uk</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/lutraconsulting"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">lutraconsulting</span></a></li><li><a href="https://github.com/lutraconsulting"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">lutraconsulting</span></a></li><li><a href="https://www.linkedin.com/in/lutra-consulting"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">lutra-consulting</span></a></li><li><a href="https://www.twitter.com/lutraconsulting"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">lutraconsulting</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Survey made easy</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
